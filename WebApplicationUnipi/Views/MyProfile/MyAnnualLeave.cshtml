@model object
@{
    ViewBag.Title = "My annual leaves";

    var availDays = ViewData["AvailableDays"];
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/js/standalone/selectize.min.js" integrity="sha256-+C0A5Ilqmu4QcSPxrlGpaZxJ04VjsRjKu+G82kl5UJk=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/css/selectize.bootstrap3.min.css" integrity="sha256-ze/OEYGcFbPRmvCnrSeKbRTtjG4vGLHXgOqsyLFTRjg=" crossorigin="anonymous" />

<div class="gridBg lfAlg rgAlg annual">
    <h3>@ViewBag.Title</h3>

    <div>
        <h4>You have <b>@availDays</b> remaining days in total.</h4>
    </div>

    <div class="tab">
        @*<button id="1" class="xtab sessionUpdate active">Remaining days</button>*@
        <button id="1" class="xtab sessionUpdate active">My requests</button>
        <button id="2" class="xtab sessionUpdate">New request</button>
        <button id="3" class="xtab sessionUpdate">Approved requests</button>
        <button id="4" class="xtab sessionUpdate">Public Holiday</button>
        <button id="5" class="xtab sessionUpdate">Cancelled Requests</button>
        <button id="6" class="xtab sessionUpdate">Rejected Requests</button>
    </div>

    @using (Html.BeginForm())
    {
        <div class="target panel panel-1">
            @Html.Action("MyLeaveRequestsGridViewPartial", "MyProfile")
        </div>
        <div class="target panel panel-2" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-3" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-4" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-5" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-6" style="transform: translate(100vw,0)"></div>
    }
    @*@Html.Partial("../ReturnedMessage/_ReturnedMessage", "New request succesfully added!")*@
    @Html.Partial("../ReturnedMessage/_ReturnedMessage", TempData["msgToRtrn"]?.ToString())


</div>

<script>
    $(document).ready(function () {
        //setTimeout(function () {
        //    $('#returnmsg').fadeOut('fast');
        //}, 3000);
        //setTimeout(function () {
        //    $('.msgPopUpRequest').fadeOut('fast');
        //}, 3000);

        $('form').submit(function () {
            $(this).find('input[type="submit"]').attr('disabled', 'disabled');
        });



        $('.xtab').on("click", function (evt) {
            if (evt.target.classList.contains("active")) return;
            $(".loader").addClass("shown")
            let dir;
            let prev = $(".xtab.active").attr("id");
            let tab = evt.target.id;



            prev > tab ? dir = -1 : dir = 1;

            var xurl;
            if (tab == "1") {
                xurl = "MyLeaveRequestsGridViewPartial";
            }
            if (tab == "2") {
                xurl = "NewLeaveRequestPartial";
            }
            if (tab == "3") {
                xurl = "MyApprovedLeavesGridViewPartial";
            }
            if (tab == "4") {
                xurl = "DaysOffGridViewPartial";
            }
            if (tab == "5") {
                xurl = "MyCancelledLeaveRequestsGridViewPartial";
            }
            if (tab == "6") {
                xurl = "MyRejectedLeavesGridViewPartial";
            }

            $.get(xurl)
                .done(function (data) {
                    underlineMove(tab);
                    $(".loader").removeClass("shown");
                    $(`.target.panel-${tab}`).html(data)
                    $(`.target.panel-${tab}`).css("transform", `translate(calc(${dir}*100vw),0)`)
                    $(`.target.panel-${tab}`).css("display", "block")
                    setTimeout(() => {
                        $(`.target.panel-${tab}`).css("transform", "unset");
                        $(`.target.panel-${tab}`).find(".dx.dxm-image-l").on("click", escapeBeforeUnload);
                    }, 10)
                    $(`.target.panel-${prev}`).css({ "display": "none" });

                    $('.xtab').removeClass("active");
                    $(`#${tab}`).addClass("active");
                });
        });
    });

</script>