@{
    ViewBag.Title = "Admin Annual Leaves";

}

   

<div class="gridBg lfAlg rgAlg annual">
    <h3>Annual Leaves</h3>

    <div class="tab">
        <button id="1" class="xtab sessionUpdate active">Requests</button>
        <button id="2" class="xtab sessionUpdate">Approved Leaves per month</button>
        <button id="3" class="xtab sessionUpdate">Approved Leaves per employee</button>
        <button id="4" class="xtab sessionUpdate">Rejected Leaves per month</button>
        <button id="5" class="xtab sessionUpdate">Cancelled Leaves</button>
    </div>

    @using (Html.BeginForm())
    {
        <div class="target panel panel-1">
            @Html.Action("LeavesRequestsGridViewPartial")
        </div>
        <div class="target panel panel-2" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-3" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-4" style="transform: translate(100vw,0)"></div>
        <div class="target panel panel-5" style="transform: translate(100vw,0)"></div>
    }

    @Html.Partial("../ReturnedMessage/_ReturnedMessage", TempData["msgToRtrn"]?.ToString())

</div>

<script>
        $(document).ready(function () {

            //setTimeout(function () {
            //    $('#returnmsg').fadeOut('fast');
            //}, 3000);
            //setTimeout(function () {
            //    $('.msgPopUpRequest').fadeOut('fast');
            //}, 3000);

            $('form').submit(function () {
                $(this).find('input[type="submit"]').attr('disabled', 'disabled');
            });

            $('.xtab').on("click", function (evt) {
                if (evt.target.classList.contains("active")) return;
                $(".loader").addClass("shown")
                let tab = evt.target.id;
                let prev = $(".xtab.active").attr("id");

                prev > tab ? dir = -1 : dir = 1;

                var xurl;
                console.log(xurl);
                if (tab == "1")
                    xurl = "../AdminAnnualLeaves/LeavesRequestsGridViewPartial";
                else if (tab == "2")
                    xurl = "../AdminAnnualLeaves/LeavesPerMonth";
                else if (tab == "3")
                    xurl = "../AdminAnnualLeaves/LeavesPerEmployee";
                else if (tab == "4")
                    xurl = "../AdminAnnualLeaves/RejectedLeavesPerMonth";
                else
                    xurl = "../AdminAnnualLeaves/CancelledLeaves";



                $.get(xurl})
                    .done(function (data) {
                        underlineMove(tab);
                        $(".loader").removeClass("shown");
                        $(`.target.panel-${tab}`).css("transform", `translate(calc(${dir}*100vw),0)`)
                        $(`.target.panel-${tab}`).css("display", "block")
                        setTimeout(() => {
                            $(`.target.panel-${tab}`).html(data).css("transform", "unset");
                            $(`.target.panel-${tab}`).find(".dx.dxm-image-l").on("click", escapeBeforeUnload);
                        }, 10)
                        $(`.target.panel-${prev}`).html("").css({ "display": "none" });

                        $('.xtab').removeClass("active");
                        $(`#${tab}`).addClass("active");
                    });

                @*$.post('@Url.Action("AdminAnnualLeaves", "LeavesPerEmployee")')
                .done(function (data) {
                    //debugger;
                    var isSuccessful = (data['success']);
                    if (isSuccessful) {

                    }
                    else {

                    }
                }).fail(function () {

                });*@
            });
        });
</script>
